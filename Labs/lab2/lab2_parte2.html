
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Laboratorio 2 - Parte 2. KNN para un problema de regresión &#8212; Modelos y Simulación de Sistemas II</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="COMPLEJIDAD DE MODELOS Y VALIDACIÓN" href="../../titles/U3_description.html" />
    <link rel="prev" title="Laboratorio 2 - Parte 1. KNN para un problema de clasificación" href="lab2_parte1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/fudea.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Modelos y Simulación de Sistemas II</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    INFORMACIÓN DEL CURSO
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Intro/Intro.html">
   INTRODUCCIÓN AL LABORATORIO
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../titles/U1_description.html">
   INTRODUCCIÓN AL MACHINE LEARNING
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../clases/clase_03_y_04_regresion_lineal_regresion_logistica.html">
     <strong>
      Regresión lineal y regresión logística
     </strong>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../clases/clase_05_Funciones_discriminantes_Gausianas.html">
     <strong>
      Modelos de clasificación empleando funciones de densidad Gausianas
     </strong>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lab1/lab1_parte1.html">
     Laboratorio 1 - Parte 1 Regresión polinomial múltiple
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lab1/lab1_parte2.html">
     Laboratorio 1 - Parte 2. Regresión logística
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../titles/U2_description.html">
   MODELOS NO PARÁMETRICOS
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../../clases/clase_06_modelos_no_parametricos.html">
     <strong>
      Modelos no parámetricos
     </strong>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lab2_parte1.html">
     Laboratorio 2 - Parte 1. KNN para un problema de clasificación
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Laboratorio 2 - Parte 2. KNN para un problema de regresión
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../titles/U3_description.html">
   COMPLEJIDAD DE MODELOS Y VALIDACIÓN
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../clases/clase_07_metricas_de_error.html">
     <strong>
      <font color="black">
       Métricas de evaluación
      </font>
     </strong>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../clases/clase_08_complejidad_modelos_sobreajuste.html">
     <strong>
      <font color="black">
       Complejidad de modelos
      </font>
     </strong>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../clases/clase_09_regularizacion.html">
     Sobreajuste y Regularización
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../titles/U4_description.html">
   APRENDIZAJE NO SUPERVISADO
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../clases/clase_10_modelos_mezclas_Gausianas.html">
     Modelos de Mezcla de Funciones Gausianas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../clases/clase_11_Unsupervised%20Learning.html">
     Clustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lab3/lab3_parte1.html">
     Laboratorio 3 - Parte 1. Comparación de metodos de clusterización
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../titles/U5_description.html">
   MODELOS DE ÁRBOLES Y ENSAMBLES
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../clases/clase_12_Boosting%2C%20Stacking.html">
     Adapting Boosting (Adaboost)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lab3/lab3_parte2.html">
     Laboratorio 3 - Parte 2. Comparación de metodos basados en árboles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../titles/U6_description.html">
   REDES NEURONALES ARTIFICIALES
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../clases/clase_13_Redes%20Neuronales%20Artificiales.html">
     Redes Neuronales Artificiales
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lab4/lab4_parte1.html">
     Laboratorio 4 - Parte 1. Redes neuronales - perceptrón multicapa
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lab4/lab4_parte2.html">
     Laboratorio 4 - Parte 2. Regularización de modelos.
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../titles/U7_description.html">
   MÁQUINAS DE VECTORES DE SOPORTE
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lab5/lab5_parte1.html">
     Laboratorio 5 - Parte 1. Redes recurrentes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lab5/lab5_parte2.html">
     Laboratorio 5 - Parte 2. Máquinas de Vectores de Soporte
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../titles/U8_description.html">
   SELECCIÓN EXTRACCIÓN DE CARACTERÍSTICAS
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lab6/lab6_parte1.html">
     Laboratorio 6 - Parte 1: Reducción de dimensión y Selección de características
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lab6/lab6_parte2.html">
     Laboratorio 6 - Parte 2: Reducción de dimensión PCA y LDA
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../titles/U9_description.html">
   SESIONES EXTRA DE LABORATORIO
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Extra/Basic_Preprocessing_FeatureEngineering.html">
     Preprocesamiento e Ingeniería de características
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Extra/DespliegueModelos.html">
     Despliegue de modelos en ambientes productivos
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://colab.research.google.com/github/mariabda2/ML_2022/blob/master/Labs/lab2/lab2_parte2.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/Labs/lab2/lab2_parte2.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejercicio-1-contextualizacion-del-problema">
   Ejercicio 1: Contextualización del problema
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejercicio-2-completar-codigo-de-k-vecinos-para-regresion">
   Ejercicio 2: Completar código de K-Vecinos para regresión.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejercicio-3-experimentos-con-knn">
   Ejercicio 3: Experimentos con KNN
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejercicio-4-ventana-de-parzen-y-experimentos">
   Ejercicio 4: Ventana de Parzen y experimentos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejercicio-5-experimentos-con-parzen">
   Ejercicio 5: Experimentos con Parzen
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Laboratorio 2 - Parte 2. KNN para un problema de regresión</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejercicio-1-contextualizacion-del-problema">
   Ejercicio 1: Contextualización del problema
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejercicio-2-completar-codigo-de-k-vecinos-para-regresion">
   Ejercicio 2: Completar código de K-Vecinos para regresión.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejercicio-3-experimentos-con-knn">
   Ejercicio 3: Experimentos con KNN
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejercicio-4-ventana-de-parzen-y-experimentos">
   Ejercicio 4: Ventana de Parzen y experimentos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejercicio-5-experimentos-con-parzen">
   Ejercicio 5: Experimentos con Parzen
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><strong>Recuerda que una vez abierto, Da clic en “Copiar en Drive”, de lo contrario no podras alamancenar tu progreso</strong></p>
<p>Nota: no olvide ir ejecutando las celdas de código de arriba hacia abajo para que no tenga errores de importación de librerías o por falta de definición de variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#configuración del laboratorio</span>
<span class="c1"># Ejecuta esta celda!</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="n">in_colab</span> <span class="o">=</span> <span class="kc">True</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">in_colab</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../commons/utils/&#39;</span><span class="p">);</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../commons/utils/data&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span> 
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;wget https://raw.githubusercontent.com/mariabda2/ML_2022/master/Labs/commons/utils/general.py -O general.py&#39;</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">general</span> <span class="kn">import</span> <span class="n">configure_lab2</span>
    <span class="n">configure_lab2</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">lab2</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">GRADER</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">part_2</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="laboratorio-2-parte-2-knn-para-un-problema-de-regresion">
<h1>Laboratorio 2 - Parte 2. KNN para un problema de regresión<a class="headerlink" href="#laboratorio-2-parte-2-knn-para-un-problema-de-regresion" title="Permalink to this headline">#</a></h1>
<section id="ejercicio-1-contextualizacion-del-problema">
<h2>Ejercicio 1: Contextualización del problema<a class="headerlink" href="#ejercicio-1-contextualizacion-del-problema" title="Permalink to this headline">#</a></h2>
<p>Para el problema de regresion usaremos la base de datos ‘The Boston Housing Dataset’, cuya descripción <a class="reference external" href="https://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html">pueden encontrarla aqui</a>. La información ya esta cargada dentro del notebook</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;muestra de los 3 primeros renglones de x:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;muestra de los 3 primeros renglones de y:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;¿el resultado de esta instrucción que información nos brinda?&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;¿el resultado de esta instrucción que información nos brinda?&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;¿el resultado de esta instrucción que información nos brinda?&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>En los problemas de regresión, es muy util explorar la distribución de la variable objetivo. Nuestro primer ejercicio consiste en:</p>
<ol class="simple">
<li><p>visualizar un histograma de la variable</p></li>
<li><p>Usar el histograma para confirmar como están distribuidos los datos</p></li>
</ol>
<p>Usa la siguiente celda para ver el comportamiento de la función para responder la pregunta abierta 1.</p>
<p>Pistas:</p>
<ol class="simple">
<li><p>Explorar la documentación de <a class="reference external" href="https://matplotlib.org/3.3.1/api/_as_gen/matplotlib.pyplot.hist.html">plt.hist</a></p></li>
<li><p>Puedes copiar y pegar los codigos de las opciones y visualizar resultados y te ayuden a verificar la justificación.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Usa esta celda para explorar la función y los datos</span>
<span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Pregunta Abierta</span>
<span class="c1">#@markdown dependiendo de los resultados de tu exploración de la función</span>
<span class="c1">#@markdown ¿cual de las siguientes afirmaciones es correcta?</span>
 
<span class="c1">#@markdown A) `plt.hist(x, bins = 2)` nos muestra la distribución de la variable objetivo usando `2` bins o &quot;cajones&quot;, cada bin tiene un color diferente.</span>
 
<span class="c1">#@markdown B) `plt.hist(y, bins = 2)` nos muestra la distribución de la variable objetivo usando `2` bins o &quot;cajones&quot;, todos los bines son azules y el eje Y del histograma nos muestra la probabilidad de cada valor</span>
 
<span class="c1">#@markdown C) `plt.hist(y, bins = 15)` nos muestra la distribución de la variable objetivo usando `15` bins o &quot;cajones&quot;, todos los bines son azules y el eje `Y` del histograma nos muestra el # de muestra que están en cada rango del eje `X`</span>
 
<span class="c1">#@markdown D) `plt.hist(x, bins = 15, facecolor=&#39;b&#39;)` nos muestra la distribución de la variable objetivo usando `15` bins o &quot;cajones&quot;, todos los bines son azules y el eje `Y` del histograma nos muestra el # de muestra que están en cada rango del eje `X`</span>
 
<span class="c1">#@markdown Selecciona dentro las lista desplegable</span>
<span class="n">respuesta_1</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c1">#@param [&quot;&quot;, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Pregunta Abierta</span>
<span class="c1">#@markdown dependiendo de los resultados de tu exploración usando el histograma,</span>
<span class="c1">#@markdown ¿que se puede decir de la distribución de los datos?</span>
<span class="c1">#@markdown ¿cual de las opciones es mejor justificada?</span>
 
<span class="c1">#@markdown A) Nuestra variable de salida puede ser modela mediante una distribución Gaussiana centrada alrededor de `20`. Ya que los valores del rango de `40-50` no tienen tanto peso</span>
 
<span class="c1">#@markdown B) Nuestra variable de salida puede ser modela mediante una distribución Gaussiana centrada alrededor de `50`. Ya que se observa una concentración de datos pequeña dentro del rango de `40-50`</span>
 
<span class="c1">#@markdown C) Se observan una concentración de datos en el rango `40-50` que nos impide asumir una distribución Gaussiana, esto implica que debemos filtrar estos valores, ya que son valores atípicos y sin importar la razón, nuestro modelo no puede tener valores atípicos</span>
 
<span class="c1">#@markdown D) Nuestra variable de salida podría ser modela mediante una distribución Gaussiana centrada alrededor de `20`, sin embargo, esta distribución no podría modelar bien los valores dentro del rango `40-50`</span>
 
<span class="c1">#@markdown Selecciona dentro las lista desplegable</span>
<span class="n">respuesta_2</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c1">#@param [&quot;&quot;, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;]</span>
</pre></div>
</div>
</div>
</div>
<p>Nuestros conjuntos de datos, siempre van a ser derivados de alguna situación, fenómeno o comportamiento del mundo real.</p>
<p>Sin embargo, el resultado de nuestro modelamiento es totalmente influenciado por la calidad de la información usada.</p>
<p>Al usar información que esté sesgada y/o que no represente en su totalidad la situación/comportamiento/fenómeno que queremos modelar, podemos incurrir en errores. Muchas veces los resultados de nuestros modelos van a ser usados para tomar decisiones que van a influenciar directamente la vida de las personas.</p>
<p>En la etapa de exploración, adicional de explorar los datos usando gráficas (como el histograma, scatter plot) y estadísticas, es vital entender la naturaleza y origen de nuestros datos.</p>
<p>Al ejecutar la celda de configuración del laboratorio, debieron observar algunas advertencias acerca del conjunto de datos. Explora un poco más estas advertencias en la documentación:</p>
<p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_boston.html">https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_boston.html</a></p>
<p>Y responde la siguiente pregunta abierta</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Pregunta Abierta</span>
<span class="c1">#@markdown En tus palabras, ¿por qué usar este conjunto de datos tiene implicaciones éticas?</span>
<span class="n">respuesta_3</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="c1">#@param {type:&quot;string&quot;}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="ejercicio-2-completar-codigo-de-k-vecinos-para-regresion">
<h2>Ejercicio 2: Completar código de K-Vecinos para regresión.<a class="headerlink" href="#ejercicio-2-completar-codigo-de-k-vecinos-para-regresion" title="Permalink to this headline">#</a></h2>
<p>Vamos a implementar ahora KNN para un problema de regresión.</p>
<p>Las mismas pistas de nuestro laboratorio anterior son de utilidad para implementar el algoritmo.</p>
<ol class="simple">
<li><p>Para el cáculo de la distancia entre vectores existen varias opciones:</p>
<ol class="simple">
<li><p>usar la función la distancia entre matrices <code class="docutils literal notranslate"><span class="pre">scipy.spatial.distance.cdist</span></code>(<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.cdist.html#scipy.spatial.distance.cdist">Ejemplo</a>)–esta puede ser usada directamente como <code class="docutils literal notranslate"><span class="pre">cdist(...)</span></code>. Entiende la salida de esta función. Al usarla, se logra un rendimiento superior.</p></li>
<li><p>usar la función la distancia euclidiana <code class="docutils literal notranslate"><span class="pre">scipy.spatial.distance.euclidean</span></code>(<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.euclidean.html">Ejemplo</a>)–pueder acceder a ella directamente como <code class="docutils literal notranslate"><span class="pre">euclidean</span></code>. Aca debe pensar en un algoritmo elemento a elemento, por lo tanto menos eficiente.</p></li>
</ol>
</li>
<li><p>También serán de utilidad las funciones <code class="docutils literal notranslate"><span class="pre">np.sort</span></code> y <code class="docutils literal notranslate"><span class="pre">np.argsort</span></code>.</p></li>
<li><p>¿cual es la unica diferencia entre el knn para clasificación y regresión? en lugar de la moda, que metodo debemos usar?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#ejercicio de código</span>
<span class="k">def</span> <span class="nf">KNN_regresion</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Funcion que implementa el modelo de K-Vecino mas cercanos</span>
<span class="sd">        para regresión</span>
<span class="sd">        </span>
<span class="sd">    args:</span>
<span class="sd">        Xtrain: es la matriz con las muestras de entrenamiento</span>
<span class="sd">        Ytrain: es un vector con los valores de salida pra cada una de las muestras de entrenamiento</span>
<span class="sd">        Xtest: es la matriz con las muestras de validación</span>
<span class="sd">        k (int): valor de vecinos a usar</span>
<span class="sd">    </span>
<span class="sd">    retorna: las estimaciones del modelo KNN para el conjunto Xtest </span>
<span class="sd">             esta matriz debe tener un shape de [row/muestras de Xtest] </span>
<span class="sd">             y las distancias de Xtest respecto a Xtrain, estan matrix</span>
<span class="sd">             debe tener un shape de [rows de Xtest, rows Xtrain]</span>
<span class="sd">             lo que es lo mismo [muestras de Xtest, muestras de Xtrain]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">Xtrain</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;k no puede ser menor que las muestras de entrenamiento&quot;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="n">distancias</span> <span class="o">=</span>  
    <span class="n">Yest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Xtest</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  
        
    <span class="k">return</span> <span class="n">Yest</span><span class="p">,</span> <span class="n">distancias</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## la funcion que prueba tu implementacion</span>
<span class="n">GRADER</span><span class="o">.</span><span class="n">run_test</span><span class="p">(</span><span class="s2">&quot;ejercicio1&quot;</span><span class="p">,</span> <span class="n">KNN_regresion</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="ejercicio-3-experimentos-con-knn">
<h2>Ejercicio 3: Experimentos con KNN<a class="headerlink" href="#ejercicio-3-experimentos-con-knn" title="Permalink to this headline">#</a></h2>
<p>Ahora vamos a probar nuestro algoritmo. Antes de ello, definos la función para calcular el error</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MAPE</span><span class="p">(</span><span class="n">Y_est</span><span class="p">,</span><span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mean Absolute Percentage Error para los problemas de regresión</span>
<span class="sd">    Y_est: numpy array con los valores estimados</span>
<span class="sd">    Y: numpy array con las etiquetas verdaderas</span>
<span class="sd">    retorna: mape</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">Y_est</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">Y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span><span class="o">/</span><span class="n">N</span>
    <span class="k">return</span> <span class="n">mape</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Pregunta Abierta</span>
<span class="c1">#@markdown En sus palabras, ¿como se puede explicar el MAPE? ¿Cuales son los valores para el caso de un modelo perfecto? ¿cuales son los valores para un modelo con falta de entrenamiento?</span>
<span class="n">respuesta_4</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="c1">#@param {type:&quot;string&quot;}</span>
</pre></div>
</div>
</div>
</div>
<p>Vamos a crear la función para experimentar.</p>
<p>En el ejercicio de código, se puede observar que usamos nuevamente la funciónes de la libreria <strong>sklearn</strong>:</p>
<ol class="simple">
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html">StandardScaler</a> para normalizar.</p></li>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">train_test_split</a>. Para dividir el conjunto de datos. Entiende como estamos usando esta función y completa el codigo para realizar 5 repeticiones.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ejercicio de código</span>
<span class="k">def</span> <span class="nf">experimentar</span> <span class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Función que realiza los experimentos con knn usando</span>
<span class="sd">       una estrategia de validacion entrenamiento y pruebas</span>

<span class="sd">    ks: List[int/float] lista con los valores de k-vecinos a usar</span>
<span class="sd">    X: matriz de numpy conjunto con muestras y caracteristicas</span>
<span class="sd">    Y: vector de numpy con los valores a predecir</span>
<span class="sd">    retorna: dataframe con los resultados, debe contener las siguientes columnas:</span>
<span class="sd">        - los k-vecinos, el error-mape medio de prueba, la desviacion estandar del error-mape</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># iteramos sobre la lista de k&#39;s</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">:</span>
        
        <span class="c1"># iteramos para validar</span>
        <span class="c1"># sobre las particiones</span>
        <span class="c1"># ¿que numero debemos asignar para lograr las particiones?</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">...</span><span class="p">):</span> 
            <span class="c1"># dividimos usando la función</span>
            <span class="n">Xtrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Ytest</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
            <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
            <span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
            <span class="n">Xtrain</span><span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
            <span class="n">Xtest</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>

            <span class="n">Yest</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="o">...</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
            <span class="n">errorTest</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="o">...</span><span class="p">,</span><span class="o">...</span><span class="p">)</span>
    
            <span class="n">resultados</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="s1">&#39;k-vecinos&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span> 
            <span class="n">resultados</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="s1">&#39;error de prueba&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
            <span class="c1">#asignamos la particion</span>
            <span class="n">resultados</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;particion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
            <span class="n">idx</span><span class="o">+=</span><span class="mi">1</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## la funcion que prueba tu implementacion</span>
<span class="n">GRADER</span><span class="o">.</span><span class="n">run_test</span><span class="p">(</span><span class="s2">&quot;ejercicio2&quot;</span><span class="p">,</span> <span class="n">experimentar</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Pregunta Abierta</span>
<span class="c1">#@markdown  Observa nuevamente el codigo y concentrate en la metodología de validación</span>
<span class="c1">#@markdown ¿cual de las opciones es mejor justificada?</span>
 
<span class="c1">#@markdown A) Al usar la función `train_test_split` estamos asegurando implementar la metodología de validación básica de la división entre conjunto de prueba y entrenamiento.</span>
 
<span class="c1">#@markdown B)  Al usar la función `train_test_split` con 5 repeticiones estamos implementando la metodología Bootstrapping.</span>
 
<span class="c1">#@markdown C) Estamos realizando validación cruzada, ya que estamos usando particiones del conjunto original de datos</span>
 
<span class="c1">#@markdown D) Al usar la función `train_test_split` 5 veces, estamos realizando 5 particiones por lo tanto estamos usando validación cruzada</span>
 
<span class="c1">#@markdown Selecciona dentro las lista desplegable</span>
<span class="n">respuesta_5</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c1">#@param [&quot;&quot;, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;]</span>
</pre></div>
</div>
</div>
</div>
<p>Ahora ejecuta los experimentos con k = 2,3,4,5,6,7,10</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="n">experimentar</span> <span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">resultados</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="ejercicio-4-ventana-de-parzen-y-experimentos">
<h2>Ejercicio 4: Ventana de Parzen y experimentos<a class="headerlink" href="#ejercicio-4-ventana-de-parzen-y-experimentos" title="Permalink to this headline">#</a></h2>
<p>Ahora, igualmente, vamos aplicar ventana de parzen para resolver el problema de regresión.</p>
<div class="math notranslate nohighlight">
\[f({\bf{x}}^*) = \frac{1}{N h^d} \sum_{i=1}^{N} K(u_i), \;\; u_i = \frac{d({\bf{x}}^*,{\bf{x}}_i)}{h}\]</div>
<p>En la siguiente celda se define la función para un <span class="math notranslate nohighlight">\(K(u_i)\)</span> gaussiano y se realiza la sugerencia para estimar el termino <span class="math notranslate nohighlight">\( \sum_{i=1}^{N} K(u_i)\)</span>, siendo <span class="math notranslate nohighlight">\(\;\; u_i = \frac{d({\bf{x}}^*,{\bf{x}}_i)}{h}\)</span>.</p>
<p>Observa y entiende esta última función y sus argumentos. Recordando que para regresión, debemos usar la relación de <strong>Nadaraya_Watson</strong>.</p>
<div class="math notranslate nohighlight">
\[y^* = \frac{\sum_{i=1}^N K(u_i)y_i}{\sum_{i=1}^N K(u_i)} \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">kernel_gaussiano</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">ParzenWindow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Data</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">Datay</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;&quot;ventana de parzen</span>
<span class="sd">    Args:</span>
<span class="sd">        x: vector con representando una sola muestra</span>
<span class="sd">        Data: vector de muestras de entrenamiento</span>
<span class="sd">        h: ancho de la ventana de kernel</span>
<span class="sd">        Datay: vector con los valores de salida (y), Si no se pasa como argumento, </span>
<span class="sd">            se calcula un ventana de parzen sin multiplicar los valores de este vector.</span>

<span class="sd">    Retorna: el valor de ventana de parzen para una muestra</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">h</span>
    <span class="n">Ns</span> <span class="o">=</span> <span class="n">Data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">suma</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ns</span><span class="p">):</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">euclidean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Data</span><span class="p">[</span><span class="n">k</span><span class="p">,:])</span>
        <span class="k">if</span> <span class="n">Datay</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">suma</span> <span class="o">+=</span> <span class="n">kernel_gaussiano</span><span class="p">(</span><span class="n">u</span><span class="o">/</span><span class="n">h</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">suma</span> <span class="o">+=</span> <span class="n">kernel_gaussiano</span><span class="p">(</span><span class="n">u</span><span class="o">/</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="n">Datay</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">suma</span>
</pre></div>
</div>
</div>
</div>
<p>Usando las anteriores funciones, completa el código.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ejercicio de código</span>
<span class="k">def</span> <span class="nf">Nadaraya_Watson</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Funcion que implementa metodo de ventana de parzen para</span>
<span class="sd">        para clasificación</span>
<span class="sd">    Args</span>
<span class="sd">        h (float): ancho de h de la ventana</span>
<span class="sd">        Xtrain: es la matriz con las muestras de entrenamiento</span>
<span class="sd">        Ytrain: es un vector con los valores de salida pra cada una de las muestras de entrenamiento</span>
<span class="sd">        Xtest: es la matriz con las muestras de validación</span>
<span class="sd">  </span>
<span class="sd">    retorna: - las estimaciones del modelo parzen para el conjunto Xtest </span>
<span class="sd">              esta matriz debe tener un shape de [row/muestras de Xtest]</span>
<span class="sd">    &quot;&quot;&quot;</span>
        
    <span class="n">Yest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Xtest</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="o">...</span>
    
    <span class="c1">#Debe retornar un vector que contenga las predicciones para cada una de las muestras en X_val, en el mismo orden.  </span>
    <span class="k">return</span> <span class="n">Yest</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## la funcion que prueba tu implementacion</span>
<span class="n">GRADER</span><span class="o">.</span><span class="n">run_test</span><span class="p">(</span><span class="s2">&quot;ejercicio3&quot;</span><span class="p">,</span> <span class="n">Nadaraya_Watson</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="ejercicio-5-experimentos-con-parzen">
<h2>Ejercicio 5: Experimentos con Parzen<a class="headerlink" href="#ejercicio-5-experimentos-con-parzen" title="Permalink to this headline">#</a></h2>
<p>En el ejercicio de código, se puede observar que usamos nuevamente la funciónes de la libreria <strong>sklearn</strong>:</p>
<ol class="simple">
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html">StandardScaler</a> para normalizar.</p></li>
<li><p>Y se debe usar la función <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html?highlight=kfold#sklearn.model_selection.KFold">KFold</a> para realizar la validación. Tener en cuenta la documentación para poder completar el código de manera correcta y usar 3 particiones.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">experimentarParzen</span> <span class="p">(</span><span class="n">hs</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Función que realiza los experimentos con knn usando</span>
<span class="sd">       una estrategia de validacion entrenamiento y pruebas</span>
<span class="sd">    </span>
<span class="sd">    hs: List[int/float] lista con los valores de h a usar</span>
<span class="sd">    X: matriz de numpy conjunto con muestras y caracteristicas</span>
<span class="sd">    Y: vector de numpy con los valores de las etiquetas</span>
<span class="sd">    </span>
<span class="sd">    retorna: dataframe con los resultados, debe contener las siguientes columnas:</span>
<span class="sd">        - el ancho de ventana, </span>
<span class="sd">        - el error medio de prueba</span>
<span class="sd">        - la desviacion estandar del error</span>
<span class="sd">        - número de promedio en el conjunto de prueba/validacion</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># se usa la función para implementar la estrategia de validación.</span>
    <span class="c1"># asgine el valor acorde</span>
    <span class="n">kfolds</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=...</span><span class="p">)</span>
    <span class="n">resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># iteramos sobre los valores de hs</span>
    
    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">hs</span><span class="p">:</span>

        <span class="c1">#contador para cada particion</span>
        <span class="n">particion</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># asigne el valor al parametro X </span>
        <span class="k">for</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">kfolds</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="o">...</span><span class="p">):</span>

            <span class="c1"># como usar train y test ?</span>
            <span class="n">Xtrain</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,:]</span>
            <span class="n">Ytrain</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="o">...</span><span class="p">]</span>
            <span class="n">Xtest</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,:]</span>
            <span class="n">Ytest</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="o">...</span><span class="p">]</span>
            <span class="c1">#normalizamos los datos</span>
            <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
            <span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
            <span class="n">Xtrain</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
            <span class="n">Xtest</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>
            
            <span class="n">Yest</span> <span class="o">=</span> <span class="n">Nadaraya_Watson</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
            <span class="n">errorTest</span> <span class="o">=</span> <span class="o">...</span><span class="p">(</span><span class="n">Yest</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">)</span>

    
            <span class="n">resultados</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="s1">&#39;ancho de ventana&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span> 
            <span class="n">resultados</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="s1">&#39;error de prueba&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
            <span class="n">resultados</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="s1">&#39;particion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">particion</span>
            <span class="n">idx</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">particion</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## la funcion que prueba tu implementacion</span>
<span class="n">GRADER</span><span class="o">.</span><span class="n">run_test</span><span class="p">(</span><span class="s2">&quot;ejercicio5&quot;</span><span class="p">,</span> <span class="n">experimentarParzen</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Pregunta Abierta</span>
<span class="c1">#@markdown Usando la función KFold implementamos la metodología de cross-validación o validación cruzada, ¿que implicaciones tiene configurar esta función con `shuffle=True`?</span>
<span class="n">respuesta_6</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="c1">#@param {type:&quot;string&quot;}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Pregunta Abierta</span>
<span class="c1">#@markdown En sus palabras, ¿cuál es la principal diferencia entre la metodología de validación cruzada y la metodología usada en el ejercicio 3 de código?</span>
<span class="n">respuesta_7</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="c1">#@param {type:&quot;string&quot;}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ejecute para ver los experimentos</span>
<span class="n">hs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.5</span> <span class="p">,</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">experimentos_parzen</span> <span class="o">=</span> <span class="n">experimentarParzen</span><span class="p">(</span><span class="n">hs</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">experimentos_parzen</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># para ver el mejor modelo</span>
<span class="c1"># vamos a calcular el valor medio</span>
<span class="c1"># Y order acorde y observamos</span>
<span class="c1"># el primer valor</span>

<span class="n">col_para_ordenar</span> <span class="o">=</span> <span class="s1">&#39;error en conjunto de prueba&#39;</span>

<span class="p">(</span><span class="n">experimentos_parzen</span>
 <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ancho de ventana&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">col_para_ordenar</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
 <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">col_para_ordenar</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
 <span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GRADER</span><span class="o">.</span><span class="n">check_tests</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Integrantes</span>
<span class="n">codigo_integrante_1</span> <span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="c1">#@param {type:&quot;string&quot;}</span>
<span class="n">codigo_integrante_2</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1">#@param {type:&quot;string&quot;}</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>esta linea de codigo va fallar, es de uso exclusivo del los profesores</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GRADER</span><span class="o">.</span><span class="n">grade</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Labs/lab2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="lab2_parte1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Laboratorio 2 - Parte 1. KNN para un problema de clasificación</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../../titles/U3_description.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">COMPLEJIDAD DE MODELOS Y VALIDACIÓN</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Profesora Maria Bernarda Salazar Sánchez -- Laboratorio por Germán E. Melo  -  Universidad de Antioquia<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>